name: Package Application with Pyinstaller

on:
  push:
    tags:
    - 'build-action-test**'
    - '[0-9]+.[0-9]+.[0-9]+'

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2

    - name: remove 'hooksconfig' from .spec
      run:  make spec-remove-hooksconfig

    - name: Package Application for Windows
      uses: NiRit100/pyinstaller-action-windows@0.1.1-a
      with:
        path: .

    - uses: actions/upload-artifact@v2
      with:
        name: Windows Standalone Binary
        path: ./dist/windows

    - name: Package Application for Linux
      run: |
        make clean
        make build_lnx

    - uses: actions/upload-artifact@v2
      with:
        name: Linux Binary
        path: ./_dist_out/lnx/
